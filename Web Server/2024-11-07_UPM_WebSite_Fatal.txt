RequestId="a2bdfcbe571f" SessionId="_4fcac303-a4d0-473a-8a96-cbecf89099be-8C710539FC1F408E89FFB6C297B17D8A" UserId="240295" UserEmail="AMoore@eab.com" DateTime="2024-11-07 09:10:11.2348" ThreadId="30" Level="FATAL" Message="The Claim 'OnBehalfExternalId: 235765' was not able to be removed.  It is either not part of this Identity or it is a claim that is owned by the Principal that contains this Identity. For example, the Principal will own the claim when creating a GenericPrincipal with roles. The roles will be exposed through the Identity that is passed in the constructor, but not actually owned by the Identity.  Similar logic exists for a RolePrincipal." Exception="System.InvalidOperationException: The Claim 'OnBehalfExternalId: 235765' was not able to be removed.  It is either not part of this Identity or it is a claim that is owned by the Principal that contains this Identity. For example, the Principal will own the claim when creating a GenericPrincipal with roles. The roles will be exposed through the Identity that is passed in the constructor, but not actually owned by the Identity.  Similar logic exists for a RolePrincipal.
   at System.Security.Claims.ClaimsIdentity.RemoveClaim(Claim claim)
   at System.Collections.Generic.List`1.ForEach(Action`1 action)
   at ABC.Common.Web.Infrastructure.Auth.AbcUserStorage`2.SetUserRole(String role, String onBehalfExternalId) in c:\git_sources\eabgo\Common\ABC.Common.Web\Infrastructure\Auth\AbcUserStorage.cs:line 114
   at ABC.UPM.Website.ApiControllers.UserController.<SetCurrentUserRoleAsync>d__18.MoveNext() in c:\git_sources\eabgo\UserProfileManager\ABC.UPM.Website\ApiControllers\UserController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Threading.Tasks.TaskHelpersExtensions.<CastToObject>d__3`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ApiControllerActionInvoker.<InvokeActionAsyncCore>d__0.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ActionFilterResult.<ExecuteAsync>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Filters.AuthorizationFilterAttribute.<ExecuteAuthorizationFilterAsyncCore>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ExceptionFilterResult.<ExecuteAsync>d__0.MoveNext()"
RequestId="cf46bc2edb6b" SessionId="_4fcac303-a4d0-473a-8a96-cbecf89099be-8C710539FC1F408E89FFB6C297B17D8A" UserId="240295" UserEmail="AMoore@eab.com" DateTime="2024-11-07 09:10:11.2348" ThreadId="14" Level="FATAL" Message="The Claim 'OnBehalfExternalId: 235765' was not able to be removed.  It is either not part of this Identity or it is a claim that is owned by the Principal that contains this Identity. For example, the Principal will own the claim when creating a GenericPrincipal with roles. The roles will be exposed through the Identity that is passed in the constructor, but not actually owned by the Identity.  Similar logic exists for a RolePrincipal." Exception="System.InvalidOperationException: The Claim 'OnBehalfExternalId: 235765' was not able to be removed.  It is either not part of this Identity or it is a claim that is owned by the Principal that contains this Identity. For example, the Principal will own the claim when creating a GenericPrincipal with roles. The roles will be exposed through the Identity that is passed in the constructor, but not actually owned by the Identity.  Similar logic exists for a RolePrincipal.
   at System.Security.Claims.ClaimsIdentity.RemoveClaim(Claim claim)
   at System.Collections.Generic.List`1.ForEach(Action`1 action)
   at ABC.Common.Web.Infrastructure.Auth.AbcUserStorage`2.SetUserRole(String role, String onBehalfExternalId) in c:\git_sources\eabgo\Common\ABC.Common.Web\Infrastructure\Auth\AbcUserStorage.cs:line 114
   at ABC.UPM.Website.ApiControllers.UserController.<SetCurrentUserRoleAsync>d__18.MoveNext() in c:\git_sources\eabgo\UserProfileManager\ABC.UPM.Website\ApiControllers\UserController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Threading.Tasks.TaskHelpersExtensions.<CastToObject>d__3`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ApiControllerActionInvoker.<InvokeActionAsyncCore>d__0.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ActionFilterResult.<ExecuteAsync>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Filters.AuthorizationFilterAttribute.<ExecuteAuthorizationFilterAsyncCore>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Web.Http.Controllers.ExceptionFilterResult.<ExecuteAsync>d__0.MoveNext()"
RequestId="cf46bc2edb6b" SessionId="_4fcac303-a4d0-473a-8a96-cbecf89099be-8C710539FC1F408E89FFB6C297B17D8A" UserId="240295" UserEmail="AMoore@eab.com" DateTime="2024-11-07 09:10:11.2826" ThreadId="14" Level="FATAL" Message="Error adding admin notification." Exception="System.ArgumentException: An item with the same key has already been added.
   at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)
   at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)
   at System.Data.Entity.Internal.InternalContext.Set[TEntity]()
   at System.Data.Entity.DbContext.Set[TEntity]()
   at ABC.Common.BL.AdminNotificationService.AddAndSaveNotifications(Subsystems subsystem, AdminNotificationSeverities severity, Boolean isEmailBody, String[] messages) in c:\git_sources\eabgo\Common\ABC.Common.BL\AdminNotificationService.cs:line 40
   at ABC.Common.Web.Infrastructure.GlobalExceptionLogger.<LogAsync>d__0.MoveNext() in c:\git_sources\eabgo\Common\ABC.Common.Web\Infrastructure\GlobalExceptionLogger.cs:line 36"
RequestId="69f6b231ab22" SessionId="_4fcac303-a4d0-473a-8a96-cbecf89099be-862B0CFFF5CFB859BF4F4882DC4E45FA" UserId="239159" UserEmail="MMcClung@eab.com" DateTime="2024-11-07 09:14:14.8926" ThreadId="22" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: 1e338202-91f7-4814-899b-68ebd47120b8. EmployeeNumber:239159X005427." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: 1e338202-91f7-4814-899b-68ebd47120b8. EmployeeNumber:239159X005427. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: 1e338202-91f7-4814-899b-68ebd47120b8. EmployeeNumber:239159X005427.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
RequestId="3ec0aa841c0c" SessionId="_daecd54f-808c-4cb8-8776-0f40490fb2a3-56E178A052AC476F20AC22B2C0321615" UserId="230727" UserEmail="kbrenneman@eab.com" DateTime="2024-11-07 19:48:15.9073" ThreadId="26" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
RequestId="383fc70f4501" SessionId="_daecd54f-808c-4cb8-8776-0f40490fb2a3-56E178A052AC476F20AC22B2C0321615" UserId="230727" UserEmail="kbrenneman@eab.com" DateTime="2024-11-07 19:48:29.9546" ThreadId="26" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
RequestId="a54d3762ed8e" SessionId="_daecd54f-808c-4cb8-8776-0f40490fb2a3-56E178A052AC476F20AC22B2C0321615" UserId="230727" UserEmail="kbrenneman@eab.com" DateTime="2024-11-07 19:48:37.1420" ThreadId="21" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
RequestId="b03bee5e6887" SessionId="_daecd54f-808c-4cb8-8776-0f40490fb2a3-56E178A052AC476F20AC22B2C0321615" UserId="230727" UserEmail="kbrenneman@eab.com" DateTime="2024-11-07 19:48:48.8166" ThreadId="36" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
RequestId="76e65c7fa3d8" SessionId="_daecd54f-808c-4cb8-8776-0f40490fb2a3-56E178A052AC476F20AC22B2C0321615" UserId="230727" UserEmail="kbrenneman@eab.com" DateTime="2024-11-07 19:48:57.8514" ThreadId="21" Level="FATAL" Message="Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514." Exception="System.ServiceModel.FaultException`1[System.ServiceModel.ExceptionDetail]: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514. (Fault Detail is equal to An ExceptionDetail, likely created by IncludeExceptionDetailInFaults=true, whose value is:
ABC.Common.BL.Exceptions.ValidationException: Unable to replace credit card when owner already has an active credit card. OwnerId: a0acbcb8-f428-4deb-8f3b-aef51a0b219f. EmployeeNumber:230727X005514.
   at ABC.Common.BL.NotificationService.ThrowValidationError(String message) in c:\git_sources\eabgo\Common\ABC.Common.BL\NotificationService.cs:line 10
   at ABC.CCM.BL.CreditCardService.<ReplaceCreditCardAsync>d__22.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.BL\CreditCardService.cs:line 196
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at ABC.CCM.Api.CardManagementApiService.<ReplaceCreditCardAsync>d__26.MoveNext() in c:\git_sources\eabgo\CreditCardManagement\ABC.CCM.Api\CardManagementApiServic...)."
